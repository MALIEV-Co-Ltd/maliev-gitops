apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: postgres-cluster-primary
spec:
  # Allow 1 unavailable for maintenance operations since we have only 1 primary
  # This allows temporary disruptions while maintaining high availability
  maxUnavailable: 1
  selector:
    matchLabels:
      cnpg.io/cluster: postgres-cluster
      cnpg.io/instanceRole: primary
---
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: postgres-cluster-replica
spec:
  # For replicas, allow 1 to be unavailable to enable rolling updates
  maxUnavailable: 1
  selector:
    matchLabels:
      cnpg.io/cluster: postgres-cluster
      cnpg.io/instanceRole: replica